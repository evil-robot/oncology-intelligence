# VIOLET — Product & Technical Specification

**Product:** VIOLET (Visual Intelligence Layer for Oncology Trends & Evidence Triangulation)
**Company:** SuperTruth Inc.
**Version:** 0.1.0
**Last Updated:** February 2026
**Classification:** CONFIDENTIAL & PROPRIETARY

---

## 1. WHAT VIOLET IS

VIOLET is an oncology and rare disease intelligence platform that transforms Google search behavior into a navigable 3D semantic map. It ingests ~750 curated oncology search terms, embeds them using OpenAI, clusters them with HDBSCAN, projects them into 3D space with UMAP, and overlays five intelligence layers on top: trend time-series, geographic health equity (CDC Social Vulnerability Index), temporal anxiety patterns, human question phrasing, and multi-source evidence triangulation from ClinicalTrials.gov, PubMed, FDA, Google Scholar, News, and Patents.

The platform answers three questions simultaneously:
- **What** exists in the oncology search field? (structural/architectural intelligence — term clusters, semantic proximity)
- **When** do people search? (temporal/anxiety intelligence — 2am search spikes, day-of-week patterns)
- **How** do people phrase their fear? (narrative intelligence — People Also Ask questions, autocomplete phrasing)

These three layers combined produce **behavioral signal intelligence** — the ability to see not just what people search for, but when they search and how they phrase it when they're scared.

---

## 2. ARCHITECTURE

### Stack

| Layer | Technology | Purpose |
|-------|-----------|---------|
| Frontend | Next.js 14, React 18, TypeScript 5.3, Tailwind CSS | Dashboard + 3D visualization |
| 3D Engine | Three.js 0.160, React Three Fiber 8.15, @react-three/drei | Interactive semantic space |
| Charts | Recharts 2.10, D3-scale | 2D trend and heatmap charts |
| State | Zustand 4.4 | Global app state |
| Backend | FastAPI, Uvicorn, Python 3.11+ | REST API + pipeline |
| Database | PostgreSQL + pgvector (Neon serverless) | Relational + vector storage |
| Embeddings | OpenAI text-embedding-3-small (1536 dims) | Semantic meaning |
| Clustering | UMAP + HDBSCAN | 3D projection + grouping |
| Trends Data | SerpAPI (Google Trends, PAA, autocomplete, Scholar, News, Patents) | Search intelligence |
| External APIs | ClinicalTrials.gov, PubMed E-utilities, FDA openFDA | Evidence triangulation |
| SDOH | CDC Social Vulnerability Index (2020) | Health equity overlay |
| Deployment | Railway.app (frontend + backend), Neon (database) | Cloud hosting |

### Diagram

```
User (Browser)
   │
   ▼
Next.js Frontend (Railway)
   │  Three.js 3D Canvas + React panels
   │  Zustand state management
   │
   ▼
FastAPI Backend (Railway)
   │  9 API route modules + chat
   │  Pipeline orchestrator (8 steps)
   │
   ├──▶ PostgreSQL + pgvector (Neon)
   │     SearchTerm, Cluster, TrendData, GeographicRegion,
   │     RelatedQuery, HourlyPattern, QuestionSurface, Post
   │
   ├──▶ OpenAI API
   │     Embeddings (text-embedding-3-small)
   │     Chat (gpt-4o-mini)
   │
   ├──▶ SerpAPI
   │     Google Trends, PAA, Autocomplete,
   │     Scholar, News, Patents
   │
   └──▶ External APIs (on-demand, not stored)
         ClinicalTrials.gov, PubMed, FDA openFDA
```

---

## 3. DATA MODEL

### SearchTerm (primary entity)
The core unit. Every search term in the taxonomy becomes a positioned point in 3D space.

| Field | Type | Description |
|-------|------|-------------|
| id | int (PK) | Auto-increment |
| term | varchar(500) | Unique search string, e.g. "BRCA gene mutation" |
| normalized_term | varchar(500) | Lowercase indexed version |
| category | varchar(100) | High-level: pediatric_oncology, adult_oncology, treatment, rare_genetic, etc. |
| subcategory | varchar(100) | Fine-grained: leukemia, brain_tumor, immunotherapy, etc. |
| parent_term_id | int (FK) | Hierarchical parent relationship |
| embedding | vector(1536) | OpenAI text-embedding-3-small |
| x, y, z | float | 3D coordinates from UMAP reduction |
| cluster_id | int (FK) | Semantic cluster assignment |

### Cluster
Semantic groupings of related terms, auto-generated by HDBSCAN.

| Field | Type | Description |
|-------|------|-------------|
| id | int (PK) | Auto-increment |
| name | varchar(200) | Auto-generated from member term names |
| description | text | Optional context |
| centroid_x, centroid_y, centroid_z | float | 3D center point |
| centroid_embedding | vector(1536) | Average embedding of members |
| color | varchar(7) | Hex color for visualization |
| size | float | Relative visual size (default 1.0) |
| term_count | int | Cached member count |
| avg_search_volume | float | Computed from TrendData |

### TrendData
Time-series search interest from Google Trends via SerpAPI.

| Field | Type | Description |
|-------|------|-------------|
| id | int (PK) | Auto-increment |
| term_id | int (FK) | Parent search term |
| date | date | Data point date |
| geo_code | varchar(10) | e.g. "US", "US-CA" |
| geo_level | varchar(20) | "country", "state", "metro" |
| interest | int | 0-100 relative search interest |
| interest_normalized | float | Normalized across time range |
| granularity | varchar(20) | "daily", "weekly", "monthly" |

### GeographicRegion
US states with CDC Social Vulnerability Index data.

| Field | Type | Description |
|-------|------|-------------|
| id | int (PK) | Auto-increment |
| geo_code | varchar(10) | Unique, e.g. "US-MS" |
| name | varchar(100) | "Mississippi" |
| level | varchar(20) | "state", "county", "metro", "country" |
| latitude, longitude | float | Centroid coordinates |
| population | int | Census data |
| svi_overall | float | 0-1, higher = more vulnerable |
| svi_socioeconomic | float | Poverty, unemployment, income, education |
| svi_household_disability | float | Disability, age, single parents |
| svi_minority_language | float | Race/ethnicity, language barriers |
| svi_housing_transport | float | Housing type, crowding, no car |
| uninsured_rate | float | Healthcare access |
| pediatric_oncology_centers | int | Nearby specialized centers |
| intent_intensity | float | Average search interest across all terms |
| vulnerability_adjusted_intent | float | Interest × (1 + SVI) |

### RelatedQuery
Discovered related searches from Google Trends — used for automatic taxonomy expansion.

| Field | Type | Description |
|-------|------|-------------|
| id | int (PK) | Auto-increment |
| source_term_id | int (FK) | Parent search term |
| query | varchar(500) | The related search string |
| query_type | varchar(50) | "rising_query", "top_query", "rising_topic", "top_topic" |
| topic_type | varchar(100) | "Disease", "Drug", "Treatment", etc. |
| value | varchar(100) | Raw: "+450%", "Breakout", "100" |
| extracted_value | float | Numeric: 450, -1 (Breakout), 100 |
| is_promoted | bool | Whether promoted to taxonomy |
| promoted_term_id | int (FK) | If promoted, the resulting SearchTerm |

### HourlyPattern
Temporal search behavior — reveals "2am anxiety" patterns.

| Field | Type | Description |
|-------|------|-------------|
| id | int (PK) | Auto-increment |
| term_id | int (FK) | Parent search term |
| hourly_avg | JSON | {0: 45, 1: 52, ..., 23: 68} — average interest by hour |
| day_of_week_avg | JSON | {"Mon": 55, ..., "Sun": 42} |
| peak_hours | JSON | Top 3 hours, e.g. [22, 23, 21] |
| anxiety_index | float | Late-night / daytime ratio (>1.0 = night-skewed) |
| late_night_avg | float | Average 11pm-4am interest |
| daytime_avg | float | Average 8am-6pm interest |

### QuestionSurface
Literal human question phrasing — "the fear phrased."

| Field | Type | Description |
|-------|------|-------------|
| id | int (PK) | Auto-increment |
| source_term_id | int (FK) | Parent search term |
| question | varchar(1000) | Full question text, e.g. "Is BRCA testing covered by insurance?" |
| snippet | text | Google's answer preview |
| source_title | varchar(500) | Title of answering page |
| source_url | varchar(2000) | URL of answering page |
| source_type | varchar(50) | "people_also_ask" or "autocomplete" |
| rank | int | Position in search results |
| fetched_at | datetime | Timestamp |

### Post
External resources positioned in the 3D semantic space.

| Field | Type | Description |
|-------|------|-------------|
| id | int (PK) | Auto-increment |
| title | varchar(500) | Resource title |
| url | varchar(2000) | External URL |
| source | varchar(100) | "pubmed", "clinical_trial", "article", etc. |
| source_id | varchar(100) | External ID (e.g. PMID) |
| content_type | varchar(50) | "article", "video", "tool", "clinical_trial" |
| embedding | vector(1536) | For semantic positioning |
| x, y, z | float | 3D coordinates near relevant cluster |
| cluster_id | int (FK) | Associated cluster |
| relevance_score | float | Semantic matching score |
| is_featured | bool | Manual curation flag |

### DataSource / PipelineRun
Pipeline tracking and execution history for auditing.

---

## 4. DATA PIPELINE

The pipeline is an 8-step sequential ETL process coordinated by `PipelineOrchestrator`.

### Step 1: Load Taxonomy
- Loads 749+ curated seed terms from `pipeline/taxonomy.py`
- Creates SearchTerm records if not existing
- Sets up parent-child relationships
- 20 categories including pediatric_oncology, adult_oncology, treatment, rare_genetic, rare_neurological, rare_autoimmune, rare_pulmonary, rare_metabolic, rare_immune, rare_cancer, clinical_trials, symptoms, diagnosis, support, survivorship, caregiver, costs, emerging, integrative, prevention
- Notable additions: SYNGAP1 and 6 related terms (SYNGAP1 syndrome, SYNGAP1 related disorder, SYNGAP1 epilepsy, SYNGAP1 gene therapy, SYNGAP1 clinical trials, SYNGAP1 intellectual disability) in rare_neurological > developmental

### Step 2: Generate Embeddings
- OpenAI text-embedding-3-small (1536 dimensions)
- Batches of 100 terms per API call
- Context-enriched: "Pediatric oncology search query about leukemia: ALL in children"

### Step 3: Cluster & Project to 3D
- UMAP: 1536-dim → 3D (n_neighbors=10, min_dist=0.5, spread=2.0, metric=cosine)
- HDBSCAN: min_cluster_size=5, min_samples=3, metric=euclidean
- Updates SearchTerm with x, y, z coordinates and cluster_id
- Creates Cluster records with centroids and colors

### Step 4: Fetch Search Trends (SerpAPI)
- For each term: interest-over-time, interest-by-region, related queries, related topics
- Timeframe: "today 5-y" (5 years)
- Geo: "US" (with state-level breakdown)
- Commits every 10 terms
- Rate limited: 0.5s delay between API calls

### Step 5: Expand Taxonomy from Discoveries
- Queries RelatedQuery records with extracted_value ≥ 200 (200%+ growth or "Breakout")
- Promotes high-value related queries to new SearchTerms
- Max 50 new terms per run
- Sets subcategory = "discovered:{query_type}"
- Re-embeds and re-clusters discovered terms

### Step 6: Fetch Questions (Question Surface)
- SerpAPI google_related_questions engine: People Also Ask (2 pages per term)
- SerpAPI google_autocomplete engine: seeded with 10 question prefixes
- Prefixes: "how do I", "where can I", "what is", "is it normal to", "can I", "why does", "what are the symptoms of", "what happens if", "how long does", "should I"
- Deduplicates across sources (PAA takes priority for richer metadata)
- Stores 8-15 questions per term

### Step 7: Fetch Hourly Patterns (Vulnerability Window)
- SerpAPI 7-day hourly data
- Computes hourly averages (0-23), day-of-week averages, peak hours
- Calculates anxiety_index = late_night_avg / daytime_avg
- Late night = 11pm-4am, Daytime = 8am-6pm

### Step 8: Load SDOH Data
- CDC Social Vulnerability Index (2020 county-level CSV)
- Aggregated to state level (population-weighted)
- Updates GeographicRegion SVI fields

---

## 5. API ENDPOINTS

### Clusters (`/api/clusters`)
- `GET /` — List all clusters (filterable by category)
- `GET /visualization` — 3D data: clusters + terms + posts with coordinates
- `GET /{cluster_id}` — Detail with member terms and posts

### Terms (`/api/terms`)
- `GET /` — Searchable, filterable term catalog
- `GET /taxonomy` — Categories with counts and subcategories
- `GET /{term_id}` — Full term detail
- `GET /{term_id}/similar` — Semantic neighbors (pgvector cosine distance)
- `GET /{term_id}/related` — Related queries from Google Trends
- `GET /{term_id}/questions` — People Also Ask questions
- `GET /discovered/all` — Auto-discovered terms from pipeline

### Trends (`/api/trends`)
- `GET /term/{term_id}` — Time-series for single term
- `GET /cluster/{cluster_id}` — Aggregated cluster trends
- `GET /top` — Highest interest terms
- `GET /comparison` — Side-by-side term comparison
- `GET /vulnerability/{term_id}` — Hourly anxiety pattern
- `GET /vulnerability/top-anxious` — Most night-searched terms

### Geography (`/api/geography`)
- `GET /regions` — All US states (filterable by level)
- `GET /regions/{geo_code}` — Region detail with SDOH
- `GET /heatmap` — Interest + vulnerability for map visualization
- `GET /sdoh-summary` — SVI statistics and high-vulnerability regions

### Insights (`/api/insights`)
- `GET /` — Detected anomalies sorted by severity
- `GET /summary` — Counts by type/severity
- `GET /term/{term_id}` — Anomalies for specific term
- `GET /cluster/{cluster_id}` — Anomalies in cluster
- Types: spike, drop, emerging, regional_outlier, seasonal_anomaly, correlation
- Severities: high, medium, low

### Questions (`/api/questions`)
- `GET /top` — Most frequent questions across all terms
- `GET /search?q=...` — Full-text search across all questions
- `GET /stats` — Coverage: total questions, by source type, terms with questions

### Triangulation (`/api/triangulate`)
- `GET /term/{term_id}` — Multi-source evidence for a term
- `GET /search` — Search any query across sources
- `GET /clinical-trials` — ClinicalTrials.gov direct search
- `GET /pubmed` — PubMed direct search
- `GET /fda` — FDA openFDA (drug approvals + adverse events)
- `GET /news` — Google News
- `GET /scholar` — Google Scholar with citation counts
- `GET /patents` — Google Patents
- `GET /sources` — List all data sources

### Compare (`/api/compare`)
- `GET /sources` — Available geo/timeframe combinations
- `GET /regions` — Single term across multiple countries
- `GET /top-terms` — Top N terms per region
- `GET /category-comparison` — Category averages by region

### Chat (`/api/chat`)
- `POST /` — Conversational AI (OpenAI gpt-4o-mini with database context)
- `GET /suggestions` — Starter questions

### Stories (`/api/stories`) — Story Builder
- `GET /context` — Fetch existing epics, sprints, features, assignees from Google Sheet for dropdowns
- `POST /assist` — LLM-powered story writing help (steps: idea, story, criteria, refine). Returns structured JSON with draft fields.
- `POST /submit` — Push completed user story to Sprint Backlog tab in Google Sheet

### Pipeline (`/api/pipeline`)
- `GET /runs` — Pipeline execution history
- `GET /runs/{run_id}` — Specific run status
- `POST /run` — Trigger full pipeline (background task)
- `GET /stats` — Current data volume (terms, clusters, trend points, regions, queries, questions)

---

## 6. FRONTEND COMPONENTS

### Main Layout (page.tsx)
Three-column layout: Left sidebar (w-72) | 3D Canvas (flex-1) | Right sidebar (w-96)

### ClusterVisualization.tsx (Core 3D Engine — ~850 lines)
The heart of the UI. Interactive Three.js scene rendered in a React Three Fiber Canvas.

Sub-components:
- **DataPoint** — Individual search term sphere with glow, hover/selection animations, color gradient cyan→pink
- **ClusterOrb** — Cluster center icosahedron with rotating wireframe rings, clickable core
- **BoundingCube** — 12-edge wireframe boundary (12×12×12 space)
- **DataConnections** — Lines from terms to cluster centroids
- **AmbientParticles** — 600 starfield background particles
- **FlyControls** — WASD first-person navigation mode
- **AutoPilot** — Cinematic camera tour with Catmull-Rom spline waypoints
- **CameraController** — Smooth lerp to store-controlled position on selection

Bottom control bar buttons: "Show All" (resets to full galaxy, only visible when a cluster/category is focused), "Auto Tour" (Catmull-Rom fly-through), "Float Mode" (WASD first-person). Clicking a cluster sets `filters.clusterId` to isolate that cluster's terms and orb; `filteredClusters` useMemo respects `clusterId` to show only the focused cluster.

### FilterPanel.tsx
- Real-time search across terms
- Expandable category accordion (25 categories with color coding)
- Geography dropdown (50 US states)
- Click category → camera animates to category centroid

### DetailPanel.tsx
Appears when a term or cluster is selected. Close (X) button calls `resetView()` — clears selection, resets filters, and snaps camera back to the full galaxy overview `[0,0,15]`.

Sections:
- Header with type badge, name, category tag
- Trend chart (Recharts LineChart, 90-day time series)
- Similar Terms (top 5 semantic neighbors, clickable)
- People Also Ask (collapsible, top 10 questions with snippets and source links)
- Top Regions (top 5 by interest)
- Google Search link

### InsightsPanel.tsx
Anomaly detection dashboard with type filters (Spikes, Emerging, Regional), severity dots, clickable cards that focus the 3D camera on the relevant term.

### VulnerabilityInsightsPanel.tsx
SDOH × Search Intent cross-reference. Formula: Interest × (1 + SVI) = Vulnerability-Adjusted Score. Sortable by combined score, interest, or vulnerability. Expandable rows with calculation breakdown.

### VulnerabilityWindow.tsx
24-hour anxiety pattern heatmaps. Two views:
- Hourly Heatmap: 24-column grid color-coded purple→pink→red, late-night zone highlighted
- Most Anxious: ranked terms by anxiety_index (late-night/daytime ratio)
Insight text dynamically generated based on anxiety_index threshold.

### DataSourcesPanel.tsx
Two tabs: All Sources (7 data sources with status) and Evidence (per-term triangulation from 6 sources with evidence strength badge).

### PipelinePanel.tsx
Stats grid (terms, trend points, regions, related queries, discovered terms, questions), status banner, run button with animated progress visualization (6-step indicator: Taxonomy → Embed → Trends → Discover → Hourly → SDOH).

### ChatPanel.tsx
Floating chat window (expandable/minimizable). OpenAI gpt-4o-mini with database context injection. Suggestion chips, conversation history, source citations.

### ExplainerPanel.tsx
Guided tour modal (? button in header) explaining the 3D map, clusters, data sources, SDOH, and AI discovery. Uses createPortal to render above Three.js canvas.

### ViewControls.tsx
Overlay toggles: Labels on/off, Connections on/off, Reset Camera, Point Size ±.

### StatsBar.tsx
Header statistics: terms count, clusters count, data points, regions, period, sources.

---

## 7. DESIGN SYSTEM

### Colors
- Background: #0a0a0f
- Surface: #12121a
- Border: #1e1e2e
- Primary: #6366f1 (Indigo) / #00d4ff (Cyan in 3D)
- Secondary: #ec4899 (Pink) / #ff6b9d (Pink in 3D)
- Tertiary: #a855f7 (Purple)
- Accent: #fbbf24 (Gold — selected items)

### Category Colors (25 mapped)
pediatric_oncology → blue-500, adult_oncology → indigo-500, rare_genetic → purple-500, rare_neurological → pink-500, clinical_trials → cyan-500, treatment → green-500, symptoms → yellow-500, diagnosis → orange-500, support → teal-500, survivorship → emerald-500, caregiver → rose-500, costs → amber-500, emerging → violet-500, integrative → lime-500, prevention → sky-500

### Glass Morphism
```css
background: rgba(12, 12, 20, 0.8);
border: 1px solid rgba(30, 30, 46, 0.5);
border-radius: 12px;
backdrop-filter: blur(12px);
```

---

## 8. DEMO MODE

When no real pipeline data exists, VIOLET generates realistic synthetic data for every endpoint:
- Trend time-series: 90-day data with seeded pseudorandom for reproducibility
- Geographic interest: MD5 hash of geo_code produces deterministic varied values per state
- Insights: Sample anomalies spread across actual taxonomy categories
- Questions: Template-based PAA questions per term ("What is {term}?", "What are the symptoms of {term}?", etc.)
- Vulnerability windows: Synthetic hourly patterns with realistic anxiety profiles

Demo mode is flagged in responses (`demo_mode: true`) so the UI can show appropriate banners.

---

## 9. ENVIRONMENT VARIABLES

### Required
- `DATABASE_URL` — PostgreSQL connection (Neon serverless, requires `sslmode=require`)
- `OPENAI_API_KEY` — For embeddings + chat
- `SERPAPI_KEY` — For Google Trends and related engines

### Optional
- `AZURE_STORAGE_CONNECTION_STRING` — Cloud blob storage
- `ENVIRONMENT` — "development" or "production"
- `LOG_LEVEL` — Default "INFO"
- `NEXT_PUBLIC_API_URL` — Backend URL for frontend

---

## 10. KEY DESIGN DECISIONS

1. **SerpAPI over pytrends**: pytrends was unreliable and rate-limited. SerpAPI provides structured JSON, supports multiple engines (Trends, PAA, Autocomplete, Scholar, News, Patents), and has consistent rate limits.

2. **Separate QuestionSurface model vs RelatedQuery**: Questions from PAA/autocomplete have fundamentally different shape (snippets, source URLs, titles) than related queries from Google Trends (growth percentages, topic types). Separate models keep the data clean.

3. **UMAP + HDBSCAN over alternatives**: UMAP preserves both local and global structure better than t-SNE for 3D projection. HDBSCAN handles noise (unclustered terms) gracefully and doesn't require specifying cluster count upfront.

4. **pgvector for semantic search**: Enables fast cosine similarity queries directly in PostgreSQL without a separate vector database. IVFFlat index keeps queries fast at scale.

5. **Batch commits every 10 terms**: Pipeline commits after every 10 terms to prevent massive transaction rollbacks if something fails mid-run.

6. **Clear-on-rerun pattern**: Pipeline deletes old data before inserting new data for each category (TrendData, RelatedQuery, QuestionSurface, HourlyPattern) to avoid duplicates without complex upsert logic.

7. **Automatic taxonomy expansion**: Related queries with 200%+ growth or "Breakout" status are auto-promoted to full SearchTerms, capped at 50 per run to prevent taxonomy explosion.

8. **Demo mode fallback**: Every endpoint can generate realistic synthetic data, enabling development and demos without requiring API keys or pipeline runs.

9. **Auto-seed taxonomy on startup**: `database.py` contains `seed_taxonomy()` which runs during `init_db()`. It loads all taxonomy terms from `pipeline/taxonomy.py` with deterministic 3D coordinates (MD5 hash-based offsets from category center positions) and creates Cluster records per category. This means deploying the code with new taxonomy terms is sufficient to make them appear in the app — no manual pipeline run needed. On subsequent startups, it detects and seeds only new terms added since the last seed.

---

## 11. FILE STRUCTURE

```
oncology-intelligence/
├── backend/
│   ├── app/
│   │   ├── main.py              # FastAPI app, middleware, router registration
│   │   ├── config.py             # Pydantic Settings (env vars)
│   │   ├── database.py           # PostgreSQL connection, schema init, SDOH seeding, taxonomy auto-seed
│   │   ├── models.py             # All SQLAlchemy models
│   │   └── routes/
│   │       ├── clusters.py       # Cluster listing, 3D viz data
│   │       ├── terms.py          # Taxonomy, similarity, questions
│   │       ├── trends.py         # Time-series, vulnerability window
│   │       ├── geography.py      # Regional SDOH heatmaps
│   │       ├── insights.py       # Anomaly detection
│   │       ├── questions.py      # Question Surface cross-term search
│   │       ├── compare.py        # Multi-region comparison
│   │       ├── triangulation.py  # External evidence APIs
│   │       ├── pipeline.py       # Pipeline management
│   │       ├── chat.py           # Conversational AI
│   │       └── stories.py       # Story Builder API (Google Sheets + LLM assist)
│   ├── pipeline/
│   │   ├── orchestrator.py       # 8-step pipeline coordinator
│   │   ├── taxonomy.py           # 749+ seed terms, 20 categories
│   │   ├── embeddings.py         # OpenAI embedding generation
│   │   ├── clustering.py         # UMAP + HDBSCAN
│   │   ├── trends_fetcher.py     # SerpAPI Google Trends client
│   │   ├── question_fetcher.py   # SerpAPI PAA + autocomplete client
│   │   ├── anomaly_detection.py  # Spike/drop/emerging detection
│   │   ├── sdoh_loader.py        # CDC SVI data loader
│   │   └── external_data.py      # ClinicalTrials, PubMed, FDA, News, Scholar, Patents
│   ├── data/
│   │   └── sample_data.json      # Demo seed data
│   ├── Dockerfile
│   ├── Procfile
│   ├── requirements.txt
│   └── pyproject.toml
├── frontend/
│   ├── app/
│   │   ├── layout.tsx            # Root layout, metadata
│   │   ├── page.tsx              # Main 3-column dashboard
│   │   ├── globals.css           # Tailwind imports
│   │   ├── login/page.tsx        # Auth page
│   │   ├── story-builder/page.tsx # LLM-guided user story wizard (for Dustin)
│   │   └── api/auth/route.ts     # Auth endpoint
│   ├── components/
│   │   ├── ClusterVisualization.tsx   # 3D engine (~850 lines)
│   │   ├── FilterPanel.tsx           # Search + category browser
│   │   ├── DetailPanel.tsx           # Term/cluster detail + questions
│   │   ├── InsightsPanel.tsx         # Anomaly dashboard
│   │   ├── VulnerabilityInsightsPanel.tsx  # SDOH × interest heatmap
│   │   ├── VulnerabilityWindow.tsx   # 24-hour anxiety patterns
│   │   ├── DataSourcesPanel.tsx      # Evidence triangulation
│   │   ├── PipelinePanel.tsx         # Pipeline control + stats
│   │   ├── ChatPanel.tsx             # AI conversation
│   │   ├── ExplainerPanel.tsx        # Guided tour modal
│   │   ├── RegionComparisonPanel.tsx # Multi-region analysis
│   │   ├── ViewControls.tsx          # Label/connection toggles
│   │   ├── StatsBar.tsx              # Header stats
│   │   ├── SuperTruthLogo.tsx        # SVG branding
│   │   └── Tooltip.tsx               # Smart-positioning tooltips
│   ├── lib/
│   │   ├── api.ts                # API client + type definitions
│   │   └── store.ts              # Zustand global state (key actions: selectAndFocusCluster sets filters.clusterId for isolation, resetView clears selection+filters+camera)
│   ├── package.json
│   ├── tsconfig.json
│   ├── next.config.js            # Standalone output, API_URL
│   └── tailwind.config.js        # Custom colors, 24-col grid
├── scripts/
│   ├── init_and_seed.py
│   ├── seed_database.py
│   └── run_pipeline.py
├── .env.example
├── railway.json
├── VIOLET_SPEC.md                # THIS FILE
├── CLAUDE.md                     # Session instructions for Claude
└── VIOLET_Demo_Script_SYNGAP1.docx  # Bobby's demo walkthrough for Becky Quick
```

---

## 12. HOW TO BRIEF CLAUDE ON VIOLET

When starting a new session (chat or Cowork), provide this context:

> Read the file VIOLET_SPEC.md in the oncology-intelligence repository root. This is the comprehensive product and technical specification for the VIOLET platform — SuperTruth Inc.'s oncology intelligence tool. It covers architecture, data models, pipeline steps, API endpoints, frontend components, and design decisions. After reading it, you'll be fully briefed on what VIOLET is and how it works.

Or simply: "Read VIOLET_SPEC.md in the repo root and get briefed."
